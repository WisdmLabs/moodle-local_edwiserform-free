{"version":3,"sources":["form_list.js"],"names":["define","$","Ajax","notification","init","PROMISES","DELETE_FORM","id","call","methodname","args","GET_FORMS","search","start","length","order","ENABLE_DISABLE_FORM","action","table","document","ready","e","data","DataTable","paging","ordering","bProcessing","bServerSide","rowId","bDeferRender","scrollY","scrollX","scrollCollapse","fixedColumns","leftColumns","rightColumns","classes","sScrollHeadInner","dom","columns","orderable","language","sSearch","M","util","get_string","emptyTable","info","end","total","infoEmpty","ajax","callback","settings","value","done","response","fail","Notification","exception","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","addClass","attr","drawCallback","removeClass","off","html","on","event","preventDefault","this","title","row","Formeo","multiActions","type","status","draw","video","string","exporttitle","message","videotypes","hasOwnProperty","window","open","val","input","formid","is","prop","parent","ex","console","log","enable_disable_form","prev","temp","append","shortcode","text","select","execCommand","remove","toaster"],"mappings":"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","sourcesContent":["/*\n * Edwiser_Forms - https://edwiser.org/\n * Version: 0.1.0\n * Author: Yogesh Shirsath\n */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'local_edwiserform/jquery.dataTables',\n    'local_edwiserform/dataTables.bootstrap4',\n    'local_edwiserform/fixedColumns.bootstrap4',\n    './iefixes',\n    'local_edwiserform/formbuilder'\n], function ($, Ajax, notification) {\n    return {\n        init: function() {\n            var PROMISES = {\n\n                /**\n                 * Delete form and data using ajax\n                 * @param  {Number}  id Form id\n                 * @return {Promise}        Ajax promise\n                 */\n                DELETE_FORM: function(id) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_delete_form', args: { id }\n                    }])[0];\n                },\n\n                /**\n                 * Get forms using ajax\n                 * @param  {String}  search Search query\n                 * @param  {Number}  length Number of courses\n                 * @param  {Number}  start  Start index of courses\n                 * @param  {Array}   order  Column order\n                 * @return {Promise}        Ajax promise\n                 */\n                GET_FORMS: function(search, start, length, order) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_get_forms',\n                        args: {\n                            search : search,\n                            start  : start,\n                            length : length,\n                            order: order\n                        }\n                    }])[0];\n                },\n\n                /**\n                 * Enable or disable form using id and action\n                 * @param  {Number}  id     Form id\n                 * @param  {Boolean} action True - Enable, False - Disable\n                 * @return {Promise}        Ajax promise\n                 */\n                ENABLE_DISABLE_FORM: function(id, action) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_enable_disable_form',\n                        args: {\n                            id     : id,\n                            action : action\n                        }\n                    }])[0];\n                }\n            };\n\n            var table = null;\n\n            $(document).ready(function (e) {\n                if ($(\".efb-wrap-list\").data(\"sesskey\") != 0) {\n                    var sesskey = $(\".efb-wrap-list\").data(\"sesskey\");\n                    table = $(\"#efb-forms\").DataTable({\n                        paging          :   true,\n                        ordering        : true,\n                        bProcessing     : true,\n                        bServerSide     : true,\n                        rowId           : 'DT_RowId',\n                        bDeferRender    : true,\n                        scrollY         : \"400px\",\n                        scrollX         : true,\n                        scrollCollapse  : true,\n                        fixedColumns    : {\n                            leftColumns     : 1,\n                            rightColumns    : 1\n                        },\n                        classes: {\n                            sScrollHeadInner: 'efb_dataTables_scrollHeadInner'\n                        },\n                        dom: '<\"efb-top\"<\"efb-listing\"l><\"efb-list-filtering\"f>>t<\"efb-bottom\"<\"efb-form-list-info\"i><\"efb-list-pagination\"p>><\"efb-shortcode-copy-note\">',\n                        columns: [\n                            { data: \"title\" },\n                            { data: \"type\" },\n                            { data: \"shortcode\" , orderable : false},\n                            { data: \"author\" },\n                            { data: \"created\" },\n                            { data: \"author2\" },\n                            { data: \"modified\" },\n                            { data: \"actions\" , orderable : false}\n                        ],\n                        language        : {\n                            sSearch: M.util.get_string('search-form', 'local_edwiserform'),\n                            emptyTable: M.util.get_string('heading-listforms-empty', 'local_edwiserform'),\n                            info: M.util.get_string('heading-listforms-showing', 'local_edwiserform', {'start': '_START_', 'end': '_END_', 'total': '_TOTAL_'}),\n                            infoEmpty: M.util.get_string('heading-listforms-showing', 'local_edwiserform', {'start': '0', 'end': '0', 'total': '0'}),\n                        },\n                        ajax: function(data, callback, settings) {\n                            PROMISES.GET_FORMS(\n                                data.search.value,\n                                data.start,\n                                data.length,\n                                data.order[0]\n                            ).done(function(response) {\n                                callback(response);\n                            }).fail(Notification.exception);\n                        },\n                        \"fnRowCallback\": function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {\n                            $('td:eq(0)', nRow).addClass( \"efb-tbl-col-title\" );\n                            $('td:eq(1)', nRow).addClass( \"efb-tbl-col-type\" );\n                            $('td:eq(2)', nRow).addClass( \"efb-tbl-col-shortcode\").attr('title', M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                            $('td:eq(3)', nRow).addClass( \"efb-tbl-col-create\" );\n                            $('td:eq(4)', nRow).addClass( \"efb-tbl-col-modified\" );\n                            $('td:eq(5)', nRow).addClass( \"efb-tbl-col-action-list\" );\n                        },\n                        drawCallback: function( settings ) {\n                            $('.efb-csv-export').removeClass('dt-button').off();\n                            $('.efb-shortcode-copy-note').html(M.util.get_string('note', 'local_edwiserform') + ' ' + M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                        }\n                    });\n                }\n\n                $('body').on('click', '.efb-form-delete', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var title = table.row(this).data().title;\n                    Formeo.dom.multiActions(\n                        'warning',\n                        M.util.get_string('warning', 'local_edwiserform'),\n                        '<h5>' + M.util.get_string('delete-form-and-data', 'local_edwiserform', {title, id}) + '</h5>',\n                        [{\n                            title: M.util.get_string('proceed', 'local_edwiserform'),\n                            type: 'danger',\n                            action: function() {\n                                PROMISES.DELETE_FORM(id).done(function(response) {\n                                    if (response.status == true) {\n                                        table.draw();\n                                    }\n                                }).fail(notification.exception);\n                            }\n                        }, {\n                            title: M.util.get_string('cancel', 'local_edwiserform'),\n                            type: 'success'\n                        }]\n                    );\n                    return;\n                });\n\n                /**\n                 * Get pro feature demo url of youtube video\n                 * @param  {string} video type of feature\n                 * @return {string}       Youtube embed video url\n                 */\n                var get_pro_demo_url = function(video) {\n                    return videotypes.hasOwnProperty(video) ? videotypes[video] : videotypes['default'];\n                }\n\n                $('body').on('click', '.efb-form-export', function(event) {\n                    event.preventDefault();\n                    var string = M.util.get_string('hey-wait', 'local_edwiserform');\n                    var exporttitle = M.util.get_string('form-action-export-title', 'local_edwiserform');\n                    var message = M.util.get_string('export-pro-message', 'local_edwiserform');\n                    message = M.util.get_string('profeaturemessage', 'local_edwiserform', {\n                        type: string + '! <b>' + exporttitle + '</b>',\n                        message: message\n                    });\n                    Formeo.dom.multiActions(\n                        'success',\n                        M.util.get_string('upgrade', 'local_edwiserform'),\n                        '<h5>' + message + '</h5><div><iframe class=\"efb-pro-demo\" src=\"' + get_pro_demo_url('export') + '\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe></div>',\n                        [{\n                            title: M.util.get_string('proceed', 'local_edwiserform'),\n                            type: 'success',\n                            action: function() {\n                                window.open($('#upgrade-url').val());\n                            }\n                        }, {\n                            title: M.util.get_string('cancel', 'local_edwiserform'),\n                            type: 'secondary'\n                        }]\n                    );\n                });\n\n                function enable_disable_form(input) {\n                    var formid = $(input).data('formid');\n                    PROMISES.ENABLE_DISABLE_FORM(formid, !$(input).is(':checked'))\n                    .done(function(response) {\n                        if (response.status) {\n                            $(input).prop('checked', $(input).is(':checked'));\n                        } else {\n                            $(input).prop('checked', !$(input).is(':checked'));\n                        }\n                        $(input).parent().attr('title', $(input).is(':checked') ? $(input).data('disable-title') : $(input).data('enable-title'))\n                    }).fail(function(ex) {\n                        console.log(ex);\n                    });\n                }\n\n                $('body').on('click', '.efb-enable-disable-form', function(event) {\n                    var input = $(this).prev();\n                    enable_disable_form(input);\n                });\n\n                $('body').on(\"click\", \".efb-tbl-col-shortcode\", function(event) {\n                    var temp = $('<input>');\n                    $('body').append(temp);\n                    var shortcode = $(this).text();\n                    temp.val(shortcode).select();\n                    document.execCommand('copy');\n                    temp.remove();\n                    Formeo.dom.toaster(M.util.get_string('shortcodecoppied', 'local_edwiserform', shortcode));\n                });\n            });\n        }\n    };\n});\n"],"file":"form_list.js"}