"use strict";define(["jquery","core/ajax","core/templates","core/notification","local_edwiserform/jquery.dataTables","local_edwiserform/dataTables.bootstrap4","local_edwiserform/fixedColumns.bootstrap4","local_edwiserform/buttons.bootstrap4","local_edwiserform/formbuilder"],function(e,o,t,i){var n=function(){0!=e(".DTFC_LeftBodyLiner tr").length&&e(".DTFC_LeftBodyLiner tr").each(function(o,t){e(t).find(".efb-data-actions span").remove();var i=e(t).find(".efb-data-action.show");i.length<2||i.slice(0,i.length-1).after("<span> | </span>")})};return{init:function(r){var s=function(e){return o.call([{methodname:"edwiserform_delete_submission",args:{id:r,submission:e}}])[0]},l=function(e,t,i){return o.call([{methodname:"edwiserform_get_form_submissions",args:{formid:r,search:e,start:t,length:i}}])[0]},a=null;e(document).ready(function(o){a=e("#efb-form-submissions").DataTable({paging:!0,ordering:!1,bProcessing:!0,bServerSide:!0,rowId:"DT_RowId",bDeferRender:!0,scrollY:"400px",scrollX:!0,scrollCollapse:!0,fixedColumns:{leftColumns:2},classes:{sScrollHeadInner:"efb_dataTables_scrollHeadInner"},dom:'<"efb-top"<"efb-listing"l><"efb-list-filtering"f>>t<"efb-bottom"<"efb-list-pagination"p><B><"efb-bulk">>i',language:{sSearch:M.util.get_string("search-form","local_edwiserform"),emptyTable:M.util.get_string("heading-listforms-empty","local_edwiserform"),info:M.util.get_string("heading-listforms-showing","local_edwiserform",{start:"_START_",end:"_END_",total:"_TOTAL_"}),infoEmpty:M.util.get_string("heading-listforms-showing","local_edwiserform",{start:"0",end:"0",total:"0"})},buttons:[],ajax:function(e,o,t){l(e.search.value,e.start,e.length).done(function(e){o(e),n()}).fail(i.exception)},drawCallback:function(o){n(),e(".efb-bottom .dt-buttons").removeClass("btn-group"),window.rendered=t.render("local_edwiserform/bulk-actions",{formid:r,wwwroot:M.cfg.wwwroot}),window.rendered.done(function(o,i){t.replaceNode(e(".efb-bulk"),o,i)}).fail(i.exception),e(".efb-shortcode-copy-note").html(M.util.get_string("clickonshortcode","local_edwiserform"))}})}),e("body").on("change",".submission-check-all",function(){e(".DTFC_Cloned .submission-check").prop("checked",e(this).is(":checked"))}),e("body").on("click",".efb-data-action.delete-action",function(o){o.preventDefault();var t=e(this).data("value");Formeo.dom.multiActions("warning",M.util.get_string("deletesubmission","local_edwiserform"),M.util.get_string("deletesubmissionmsg","local_edwiserform"),[{title:M.util.get_string("proceed","local_edwiserform"),type:"danger",action:function(){Formeo.dom.loading(),s(t).done(function(o){1==o.status&&(Formeo.dom.alert("success","<div class='col-12'>".concat(o.msg,"</div>")),a.draw(),e(".submission-check-all").prop("checked",!1)),Formeo.dom.loadingClose()}).fail(function(e){i.exception(e),Formeo.dom.loadingClose()})}},{title:M.util.get_string("cancel","local_edwiserform"),type:"success"}])}),e("body").on("click",".efb-actions a",function(e){e.preventDefault()})}}});