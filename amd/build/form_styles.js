"use strict";define(["jquery","core/ajax"],function(e,t){e(document).click(function(t){var i=e(".select-container.active");e(t.target).parents(".select-container");i.is(t.target)||0!==i.has(t.target).length||e(i).removeClass("active"),i.length>1&&e.each(i,function(i,n){0===e(n).has(t.target).length&&e(n).removeClass("active")})}).keydown(function(t){var i=e(".select-container.active");if(0===i.length)return!0;if(-1==[13,27,33,34,35,36,38,40].indexOf(t.keyCode))return!0;var n=e(i).find(".select-list"),s=e(n).find(".select-list-item:not(.d-none)");if(0==s.length)return!1;var a=e(n).find(".select-list-item.active"),l=e(s).index(a),c=!1;switch(t.keyCode){case 13:e(a).trigger("click");break;case 27:e(i).removeClass("active");break;case 33:l>0&&(c=(c=l-10)<=0?0:c);break;case 34:l<s.length-1&&(c=(c=l+10)>s.length-1?s.length-1:c);break;case 35:c=s.length-1;break;case 36:c=0;break;case 38:l>0&&(c=l-1);break;case 40:l<s.length-1&&(c=l+1)}return!1!==c&&-1!=[33,34,35,36,38,40].indexOf(t.keyCode)&&(e(n).find(".select-list-item").removeClass("active"),e(s[c]).addClass("active"),e(n).scrollTop(e(n).scrollTop()+e(s[c]).position().top-e(s[c]).height()-14)),!1}),window.addEventListener("keydown",function(t){if(0===e(".select-container.active").length)return!0;switch(t.keyCode){case 37:case 39:case 38:case 40:case 32:t.preventDefault()}},!1),e("body").on("focus",".form-control",function(){e(this).parent().addClass("active")}).on("change blur",".form-control",function(t){""===e(this).val()&&e(this).parent().removeClass("active")}).on("click",".selected-option",function(){var t=this;if(e(this).parents(".select-container").toggleClass("active"),e(this).parents(".select-container").is(".active")){var i=function(t,i){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||e(t).find(".select-list-item").removeClass("active"),e(t).find('.select-list-item[data-value="'+i+'"]').addClass("active")},n=e(this).parents(".select-container").siblings("select").val(),s=null;e.isArray(n)?(e.each(n,function(n,s){i(e(t).next(),s,!0)}),s=e(e(this).next().find(".select-list-item.active")[0]).position().top):(i(e(this).next(),n),s=e(this).next().find(".select-list-item.active").position().top),e(this).next().scrollTop(e(this).next().scrollTop()+s),e(this).next().find(".select-list-search").focus()}}).on("click",".select-list-item",function(){var t=e(this).parents(".select-container").siblings("select");if(!e(t).is('[multiple="true"]'))return i(e(t),e(this).data("value")),void e(this).parents(".select-container").removeClass("active");var s=e(t).val();e(this).is(".active")?(s.splice(s.indexOf(e(this).data("value")),1),e(this).removeClass("active")):(s.push(e(this).data("value")),e(this).addClass("active")),e(t).val(s),n(t)}).on("mouseover",".select-list-item",function(){}).on("click",".select-file-button",function(){e(this).parents(".file-container").prev().click()}).on("change",'.input-file-wrapper input[type="file"]',function(t){0!=e(this)[0].files.length?(e(this).next().find(".selected-file").val(e(this)[0].files[0].name),e(this).parents(".input-file-wrapper").addClass("active")):(e(this).next().find(".selected-file").val(""),e(this).parents(".input-file-wrapper").removeClass("active"))}).on("input",'.select-list-wrapper input[type="text"].select-list-search',function(t){var i=e(this).val().trim().toLowerCase(),n=e(this).parents(".select-list-wrapper").find("ul.select-list");e(n).find(".select-list-item").each(function(t,n){e(n).toggleClass("d-none",""!=i&&-1==e(n).text().toLowerCase().search(i))}),e(n).find(".active").removeClass("active"),e(e(n).find(".select-list-item:not(.d-none)")[0]).addClass("active")});var i=function(t,i){e(t).val(i)[0].dispatchEvent(new CustomEvent("change",{target:e(t)[0]})),i=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return""!==i?e(t).find('option[value="'+i+'"]'):e(t).find('option[value="'+e(t).val()+'"]')}(e(t)),e("#select-"+e(t).attr("id")+" .selected-option").attr("selected",i.attr("value")),e("#select-"+e(t).attr("id")+" .selected-option").text(i.attr("label"))},n=function(t){var i=e(t).val();e.each(i,function(n,s){s=e(t).find('option[value="'+s+'"]'),i[n]=e(s).attr("label")}),i.length<4?e(t).next().find(".selected-option").text(i.join(", ")):e(t).next().find(".selected-option").text(M.util.get_string("options-selected-count","local_edwiserform",{count:i.length,max:e(t).find("option").length}))},s={"style-2":{add:function(t){e(t).find("select").each(function(t,i){e(i).hide();var s=e(i).attr("id");if(e(i).after('<div class="select-container'.concat(e(i).is('[multiple="true"]')?" multiple":"",'" id="select-').concat(s,'"></div>')),e("#select-"+s).append('<div class="selected-option form-control f-addon"></div>'),e(i).is('[multiple="true"]'))n(i);else{var a=e(i).find('option[value="'+e(i).val()+'"]');e("#select-".concat(s," .selected-option")).text(e(a).attr("label"))}e("#select-"+s).append('\n                <div class="select-list-wrapper">\n                    <div class="select-list-search-wrapper">\n                        <i class="fa fa-search" aria-hidden="true"></i>\n                        <input type="text" class="select-list-search"/>\n                    </div>\n                    <ul class="select-list" id="select-list-'.concat(s,'" for="').concat(s,'"></ul>\n                </div>')),e(i).find("option").each(function(t,i){var n=e("<li></li>");e(n).addClass("select-list-item"),e(n).attr("data-value",e(i).attr("value")),e(n).text(e(i).attr("label")),e("#select-list-"+s).append(n)})}),function(t){e(t).find('input[type="file"]').each(function(t,i){e(i).hide();var n=e(i).attr("id"),s="";0!=e(this)[0].files.length&&(s=e(this)[0].files[0].name),e(i).after('<div class="file-container f-addon" id="file-'.concat(n,'"></div>')),e("#file-"+n).append('<div class="file-input-selected-wrapper"><input type="text" disabled class="selected-file" value="'+s+'"/></div>'),e("#file-"+n).append('<div class="file-input-button-wrapper"><button class="btn btn-primary select-file-button" type="button"><i class="fa fa-upload" aria-hidden="true"></i></button></div>'),0!=e(this)[0].files.length&&e(i).parents(".input-file-wrapper").addClass("active")})}(t)},remove:function(t){e(t).find("select").each(function(t,i){e(i).show().next(".select-container").remove()}),e(t).find('input[type="file"]').each(function(t,i){e(i).show().next(".file-container").remove()})}}};return s["style-3"]=s["style-2"],s["style-4"]=s["style-2"],{apply:function(t,i,n){return e(t)[i+"Class"]("form-style-"+n),null==s["style-"+n]||s["style-"+n][i](t)}}});