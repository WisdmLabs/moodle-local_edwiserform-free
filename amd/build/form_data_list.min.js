"use strict";define(["jquery","core/ajax","core/templates","core/notification","local_edwiserform/jquery.dataTables","local_edwiserform/dataTables.bootstrap4","local_edwiserform/fixedColumns.bootstrap4","local_edwiserform/buttons.bootstrap4","./iefixes","local_edwiserform/formbuilder"],function(e,o,t,i){var s=function(){0!=e(".DTFC_LeftBodyLiner tr").length&&e(".DTFC_LeftBodyLiner tr").each(function(o,t){e(t).find(".efb-data-actions span").remove();var i=e(t).find(".efb-data-action.show");i.length<2||i.slice(0,i.length-1).after("<span> | </span>")})};return{init:function(n){var a={DELETE_SUBMISSION:function(e){return o.call([{methodname:"edwiserform_delete_submissions",args:{id:n,submissions:e}}])[0]},GET_FORM_SUBMISSIONS:function(e,t,i){return o.call([{methodname:"edwiserform_get_form_submissions",args:{formid:n,search:e,start:t,length:i}}])[0]}},l=null;function r(o){Formeo.dom.multiActions("warning",M.util.get_string("deletesubmission","local_edwiserform"),M.util.get_string("deletesubmissionmsg","local_edwiserform"),[{title:M.util.get_string("proceed","local_edwiserform"),type:"danger",action:function(){Formeo.dom.loading(),a.DELETE_SUBMISSION(o).done(function(o){1==o.status&&(Formeo.dom.alert("success",'<div class="col-12">'+o.msg+"</div>"),l.draw(),e(".submission-check-all").prop("checked",!1)),Formeo.dom.loadingClose()}).fail(function(e){i.exception(e),Formeo.dom.loadingClose()})}},{title:M.util.get_string("cancel","local_edwiserform"),type:"success"}])}e(document).ready(function(){l=e("#efb-form-submissions").DataTable({paging:!0,ordering:!1,bProcessing:!0,bServerSide:!0,rowId:"DT_RowId",bDeferRender:!0,scrollY:"400px",scrollX:!0,scrollCollapse:!0,fixedColumns:{leftColumns:2},classes:{sScrollHeadInner:"efb_dataTables_scrollHeadInner"},dom:'<"efb-top"<"efb-listing"l><"efb-list-filtering"f>>t<"efb-bottom"<"efb-list-pagination"p><B><"efb-bulk">>i',language:{sSearch:M.util.get_string("search-entry","local_edwiserform"),emptyTable:M.util.get_string("listformdata-empty","local_edwiserform"),info:M.util.get_string("heading-listforms-showing","local_edwiserform",{start:"_START_",end:"_END_",total:"_TOTAL_"}),infoEmpty:M.util.get_string("heading-listforms-showing","local_edwiserform",{start:"0",end:"0",total:"0"})},buttons:[],ajax:function(e,o,t){a.GET_FORM_SUBMISSIONS(e.search.value,e.start,e.length).done(function(e){o(e),s()}).fail(i.exception)},drawCallback:function(o){s(),e(".efb-bottom .dt-buttons").removeClass("btn-group"),window.rendered=t.render("local_edwiserform/bulk-actions",{formid:n,wwwroot:M.cfg.wwwroot}),window.rendered.done(function(o,i){t.replaceNode(e(".efb-bulk"),o,i)}).fail(i.exception),e(".efb-shortcode-copy-note").html(M.util.get_string("clickonshortcode","local_edwiserform"))}})}),e("body").on("change",".submission-check-all",function(){e(".DTFC_Cloned .submission-check").prop("checked",e(this).is(":checked"))}),e("body").on("click","#efb-apply-actions",function(o){switch(o.preventDefault(),e("#efb-bulk-actions").val()){case"bulkaction":Formeo.dom.toaster(M.util.get_string("selectbulkaction","local_edwiserform"));break;case"delete":if(!e(".submission-check").is(":checked"))return void Formeo.dom.toaster(M.util.get_string("emptysubmission","local_edwiserform"));var t=[];e(".submission-check:checked").each(function(o,i){t.push(e(i).data("value"))}),r(t)}}),e("body").on("click",".efb-data-action.delete-action",function(o){o.preventDefault(),r([e(this).data("value")])}),e("body").on("click",".efb-actions a",function(e){e.preventDefault()}),e("body").on("click",".data-toggler",function(){var o=e(this).closest(".efb-table-data-expand");o.is(".expanded")?(o.removeClass("expanded"),o.find(".table-data").html(o.data("short")),e(this).text(M.util.get_string("readmore","local_edwiserform"))):(o.addClass("expanded"),o.find(".table-data").html(o.data("long")),e(this).text(M.util.get_string("readless","local_edwiserform"))),l.columns.adjust()})}}});
//# sourceMappingURL=form_data_list.min.js.map
