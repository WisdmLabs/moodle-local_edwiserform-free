{"version":3,"sources":["form_list.js"],"names":["define","$","Ajax","notification","init","PROMISES","DELETE_FORM","id","call","methodname","args","GET_FORMS","search","start","length","order","ENABLE_DISABLE_FORM","action","table","document","ready","data","DataTable","paging","ordering","bProcessing","bServerSide","rowId","bDeferRender","scrollY","scrollX","scrollCollapse","fixedColumns","leftColumns","rightColumns","classes","sScrollHeadInner","dom","columns","orderable","class","language","sSearch","M","util","get_string","emptyTable","info","end","total","infoEmpty","ajax","callback","settings","value","done","response","fail","exception","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","addClass","attr","drawCallback","removeClass","off","html","on","event","preventDefault","this","title","row","Formeo","multiActions","type","status","draw","video","string","exporttitle","message","videotypes","hasOwnProperty","window","open","val","input","formid","is","prop","parent","ex","console","log","enableDisableForm","prev","temp","append","shortcode","text","select","execCommand","remove","toaster"],"mappings":"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","sourcesContent":["/*\n * Edwiser_Forms - https://edwiser.org/\n * Version: 0.1.0\n * Author: Yogesh Shirsath\n */\n/* eslint-disable babel/object-curly-spacing */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'local_edwiserform/jquery.dataTables',\n    'local_edwiserform/dataTables.bootstrap4',\n    'local_edwiserform/fixedColumns.bootstrap4',\n    './iefixes',\n    'local_edwiserform/formbuilder'\n], function($, Ajax, notification) {\n    return {\n        init: function() {\n            var PROMISES = {\n\n                /**\n                 * Delete form and data using ajax\n                 * @param  {Number}  id Form id\n                 * @return {Promise}        Ajax promise\n                 */\n                DELETE_FORM: function(id) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_delete_form',\n                        args: { id }\n                    }])[0];\n                },\n\n                /**\n                 * Get forms using ajax\n                 * @param  {String}  search Search query\n                 * @param  {Number}  start  Start index of courses\n                 * @param  {Number}  length Number of courses\n                 * @param  {Array}   order  Column order\n                 * @return {Promise}        Ajax promise\n                 */\n                GET_FORMS: function(search, start, length, order) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_get_forms',\n                        args: {\n                            search: search,\n                            start: start,\n                            length: length,\n                            order: order\n                        }\n                    }])[0];\n                },\n\n                /**\n                 * Enable or disable form using id and action\n                 * @param  {Number}  id     Form id\n                 * @param  {Boolean} action True - Enable, False - Disable\n                 * @return {Promise}        Ajax promise\n                 */\n                ENABLE_DISABLE_FORM: function(id, action) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_enable_disable_form',\n                        args: {\n                            id: id,\n                            action: action\n                        }\n                    }])[0];\n                }\n            };\n\n            var table = null;\n\n            // Document ready.\n            $(document).ready(function() {\n                if ($(\".efb-wrap-list\").data(\"sesskey\") != 0) {\n                    table = $(\"#efb-forms\").DataTable({\n                        paging: true,\n                        ordering: true,\n                        bProcessing: true,\n                        bServerSide: true,\n                        rowId: 'DT_RowId',\n                        bDeferRender: true,\n                        scrollY: \"400px\",\n                        scrollX: true,\n                        scrollCollapse: true,\n                        fixedColumns: {\n                            leftColumns: 1,\n                            rightColumns: 1\n                        },\n                        classes: {\n                            sScrollHeadInner: 'efb_dataTables_scrollHeadInner'\n                        },\n                        // eslint-disable-next-line max-len\n                        dom: '<\"efb-top\"<\"efb-listing\"l><\"efb-list-filtering\"f>>t<\"efb-bottom\"<\"efb-form-list-info\"i><\"efb-list-pagination\"p>><\"efb-shortcode-copy-note\">',\n                        columns: [\n                            { data: \"title\" },\n                            { data: \"type\" },\n                            { data: \"shortcode\", orderable: false },\n                            { data: \"author\" },\n                            { data: \"created\" },\n                            { data: \"author2\" },\n                            { data: \"modified\" },\n                            { data: \"actions\", orderable: false, 'class': 'text-center' }\n                        ],\n                        language: {\n                            sSearch: M.util.get_string('search-form', 'local_edwiserform'),\n                            emptyTable: M.util.get_string('heading-listforms-empty', 'local_edwiserform'),\n                            info: M.util.get_string(\n                                'heading-listforms-showing',\n                                'local_edwiserform', { 'start': '_START_', 'end': '_END_', 'total': '_TOTAL_' }\n                            ),\n                            infoEmpty: M.util.get_string(\n                                'heading-listforms-showing',\n                                'local_edwiserform', { 'start': '0', 'end': '0', 'total': '0' }\n                            ),\n                        },\n                        // eslint-disable-next-line\n                        ajax: function(data, callback, settings) {\n                            PROMISES.GET_FORMS(\n                                data.search.value,\n                                data.start,\n                                data.length,\n                                data.order[0]\n                            ).done(function(response) {\n                                callback(response);\n                            }).fail(notification.exception);\n                        },\n                        // eslint-disable-next-line\n                        \"fnRowCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n                            $('td:eq(0)', nRow).addClass(\"efb-tbl-col-title\");\n                            $('td:eq(1)', nRow).addClass(\"efb-tbl-col-type\");\n                            $('td:eq(2)', nRow).addClass(\"efb-tbl-col-shortcode\").attr(\n                                'title',\n                                M.util.get_string('clickonshortcode', 'local_edwiserform')\n                            );\n                            $('td:eq(3)', nRow).addClass(\"efb-tbl-col-create\");\n                            $('td:eq(4)', nRow).addClass(\"efb-tbl-col-modified\");\n                            $('td:eq(5)', nRow).addClass(\"efb-tbl-col-action-list\");\n                        },\n                        // eslint-disable-next-line\n                        drawCallback: function(settings) {\n                            $('.efb-csv-export').removeClass('dt-button').off();\n                            $('.efb-shortcode-copy-note').html(M.util.get_string('note', 'local_edwiserform') +\n                                ' ' + M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                        }\n                    });\n                }\n\n                $('body').on('click', '.efb-form-delete', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var title = table.row(this).data().title;\n                    // eslint-disable-next-line\n                    Formeo.dom.multiActions(\n                        'warning',\n                        M.util.get_string('warning', 'local_edwiserform'),\n                        '<h5>' + M.util.get_string('delete-form-and-data', 'local_edwiserform', { title, id }) + '</h5>', [{\n                            title: M.util.get_string('proceed', 'local_edwiserform'),\n                            type: 'danger',\n                            action: function() {\n                                PROMISES.DELETE_FORM(id).done(function(response) {\n                                    if (response.status == true) {\n                                        table.draw();\n                                    }\n                                }).fail(notification.exception);\n                            }\n                        }, {\n                            title: M.util.get_string('cancel', 'local_edwiserform'),\n                            type: 'success'\n                        }]\n                    );\n                    return;\n                });\n\n                /**\n                 * Get pro feature demo url of youtube video\n                 * @param  {string} video type of feature\n                 * @return {string}       Youtube embed video url\n                 */\n                var getProDemoUrl = function(video) {\n                    // eslint-disable-next-line\n                    return videotypes.hasOwnProperty(video) ? videotypes[video] : videotypes['default'];\n                };\n\n                $('body').on('click', '.efb-form-export', function(event) {\n                    event.preventDefault();\n                    var string = M.util.get_string('hey-wait', 'local_edwiserform');\n                    var exporttitle = M.util.get_string('form-action-export-title', 'local_edwiserform');\n                    var message = M.util.get_string('export-pro-message', 'local_edwiserform');\n                    message = M.util.get_string('profeaturemessage', 'local_edwiserform', {\n                        type: string + '! <b>' + exporttitle + '</b>',\n                        message: message\n                    });\n                    // eslint-disable-next-line\n                    Formeo.dom.multiActions(\n                        'success',\n                        M.util.get_string('upgrade', 'local_edwiserform'),\n                        '<h5>' + message + '</h5><div><iframe class=\"efb-pro-demo\" src=\"' +\n                        getProDemoUrl('export') +\n                        '\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe></div>', [{\n                            title: M.util.get_string('proceed', 'local_edwiserform'),\n                            type: 'success',\n                            action: function() {\n                                window.open($('#upgrade-url').val());\n                            }\n                        }, {\n                            title: M.util.get_string('cancel', 'local_edwiserform'),\n                            type: 'secondary'\n                        }]\n                    );\n                });\n\n                /**\n                 * Enable disable form\n                 * @param {DOM} input Input element\n                 */\n                function enableDisableForm(input) {\n                    var formid = $(input).data('formid');\n                    PROMISES.ENABLE_DISABLE_FORM(formid, !$(input).is(':checked'))\n                        .done(function(response) {\n                            if (response.status) {\n                                $(input).prop('checked', $(input).is(':checked'));\n                            } else {\n                                $(input).prop('checked', !$(input).is(':checked'));\n                            }\n                            $(input).parent().attr('title', $(input).is(':checked') ?\n                                $(input).data('disable-title') :\n                                $(input).data('enable-title'));\n                        }).fail(function(ex) {\n                            // eslint-disable-next-line\n                            console.log(ex);\n                        });\n                }\n\n                // Enable disable form.\n                $('body').on('click', '.efb-enable-disable-form', function() {\n                    var input = $(this).prev();\n                    enableDisableForm(input);\n                });\n\n                // Copy shortcode.\n                $('body').on(\"click\", \".efb-tbl-col-shortcode\", function() {\n                    var temp = $('<input>');\n                    $('body').append(temp);\n                    var shortcode = $(this).text();\n                    temp.val(shortcode).select();\n                    document.execCommand('copy');\n                    temp.remove();\n                    // eslint-disable-next-line\n                    Formeo.dom.toaster(M.util.get_string('shortcodecoppied', 'local_edwiserform', shortcode));\n                });\n            });\n        }\n    };\n});"],"file":"form_list.min.js"}